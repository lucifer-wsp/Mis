<html>
    <head>
        <script src='./JQuery/jquery-3.2.1.min.js' type='text/javascript'></script>
        <script src='./JQuery/jquery.easyui.min.js' type='text/javascript'></script>
        <script>
            $(document).ready(
                function(){
                    $("#search_btn").click(
                        function(){
                            var pid_value = $("#keyword_txt").val();
                            if(!pid_value || true != check_in(pid_value)){
                                alert('input error, format must be 18812345678 or 029-12345678');
                                return ;
                            }
                            post_req(pid_value);
                            console.log('search');
                        }
                    );
                }
            );

            $(window).on('load', function (){
                //console.log('load');
                var loc_url = location.href + "";
                if(loc_url.indexOf('?') > -1){
                    var param = loc_url.split('?')[1].split('&')[0];
                    var pid_name = param.split('=')[0].trim();
                    var pid_value = param.split('=')[1].trim();

                    if('pid' != pid_name || !check_in(pid_value)){
                        return ;
                    }
                    $("#keyword_txt").val(pid_value);
                    post_req(pid_value);
                }
            });

            function check_in(pid){
                var chk_phone = {chk_mobile: /^0?1[3|4|5|8|7][0-9]\d{8}$/,
                                chk_tel: /^0[\d]{2,3}-[\d]{7,8}$/};

                if(pid && (chk_phone.chk_mobile.test(pid) || chk_phone.chk_tel.test(pid))){
                    return true;
                }
                return false;
            }

            function post_req(pid_value){
                if(pid_value){
                    $.post("http://www.splovem.com/search", {pid: pid_value}, function(result){
                        var data=result['result'];
                        var inner_html = '';
                        for(var i = 0;i < data.length; i++){
                            inner_html += '<tr>';
                            data[i]
                        }
                        $("#body").html(inner_html);
                    });
                }
            }
        </script>
        <style>
            .search_btn_cls {width: 45%; height: 28px; border: none; background: #00a57f; outline: none; }
            .search_btn_cls:hover {background: #00b38a;}
        </style>
    </head>

    <body>
        <meta http-equit='Access-Control-Allow-Origin' content='*' />
        <div id='top' style='' >
            <div style='float: left; width: 30%; '>
                <a href='./index.html'><img src='./Icon/splmm.ico' style='width: 20%;' /></a>
            </div>
            <div style='float: left; width: 60%; hight: 50px; position: absolute; top: 30px; right: 0px;'>
                <div style='float:left; width: 65%; border: green solid 0px; text-align: right;'>
                    <input id='keyword_txt' type='text' style='height: 28px; width:55%; font-size: 16px; border: #00a57f solid 2px; outline: none;' />
                </div>
                <div style='float:left; width: 25%; border: green solid 0px; text-align: left;'>
                    <button id='search_btn' type='button' class='search_btn_cls' clickon=''/>Search</button>
                </div>
            </div>
        </div>

        <div id='body' style='position: absolute; top: 150px; width: 99%;border: green solid 1px;'>
            <table id="dg" title="" style="width:100%;height:250px" data-options="rownumbers:true,singleSelect:true">
                <thead>
                    <tr>
                        <th data-options="field:'ck',checkbox:true" style='width: 10%'></th>
                        <th data-options="field:'itemid'" style='width: 10%'>Item ID</th>
                        <th data-options="field:'phone number'" style='width: 20%'>Phone number</th>
                        <th data-options="field:'detail info',align:'center'" style='width: 40%'>Detail info</th>
                        <th data-options="field:'time stamp',align:'center'" style='width: 20%'>Time stamp</th>
                    </tr>
                </thead>
            </table>
        </div>

        <div id='footer' style='position: absolute; bottom: 20px; left: 20px;'>
            <a href='' style='text-decoration: none; color: #00a57f; font-size: 13px;'>关于我们</a>
            <a href='' style='text-decoration: none; color: #00a57f; font-size: 13px;'>联系我们</a>
        </div>
    </body>
</html>